---
title: "Homework 05 - Putting it all together!"
author: "Sandy Sotelo"
date: "11/13/2025"
output: html_document
---

### Load packages and data

```{r load-packages, message=FALSE}
library(tidyverse)
```

## Exercises

### Exercise 1

```{r read-tornado}
tornado <- read_csv("data/tornado-path.csv")

glimpse(tornado)

```


### Exercise 2

```{rr select-tornado}
tornado <- read_csv("data/tornado-path.csv") %>%
  select(
    storm_date, storm_time, state_name,
    magnitude, fatality_count, length, width
  )
```

### Exercise 3
```{r write-tornado}
write_csv(tornado, "data/tornado.csv")
```


### Exercise 4
```{r read-fix-magnitude}
tornado_fixed <- read_csv(
  "data/tornado.csv",  
  na = "-9"
)
glimpse(tornado_fixed)
```

### Exercise 5
```{r tornado-plot}
tornado_fixed %>% 
  filter(state_name %in% c("Kansas", "Oklahoma")) %>% 
  ggplot(aes(x = storm_time,
             y = fatality_count,
             color = state_name,
             size = width)) +
  geom_point(alpha = 0.6) +
  facet_wrap(~ magnitude) +
  labs(
    title = "Tornado fatalities in Kansas and Oklahoma by time of day",
    x = "Time of day",
    y = "Number of fatalities",
    color = "State",
    size = "Tornado width"
  ) +
  theme_minimal()

```
In general, tornadoes with higher magnitudes tend to have higher fatality counts, and many of the larger-fatality events occur later in the day. Most tornadoes cause zero fatalities, and there are relatively few very severe events, so patterns for the highest magnitudes are based on small sample sizes. Reporting issues and missing data also mean these trends should be interpreted with caution.
